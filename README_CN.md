# FinanceMCP - 专业金融数据MCP服务器 🚀

[![smithery badge](https://smithery.ai/badge/@guangxiangdebizi/FinanceMCP)](https://smithery.ai/server/@guangxiangdebizi/FinanceMCP)

欢迎使用 **FinanceMCP** - 基于模型上下文协议（MCP）的专业金融数据服务器！本项目通过集成 **Tushare API** 为语言模型（如Claude）提供全面的实时金融数据访问能力，支持股票、基金、债券、宏观经济指标等多维度金融数据分析。

## 🌟 核心特性

### 📈 多市场股票数据
支持全球主要市场的股票数据查询：
* **A股市场**（沪深两市）- 如：平安银行 (000001.SZ)
* **美股市场**（纳斯达克、纽交所等）- 如：苹果 (AAPL)
* **港股市场**（香港交易所）- 如：腾讯控股 (00700.HK)
* **外汇市场**（主要货币对）- 如：美元人民币 (USDCNH.FXCM)
* **期货市场**（商品期货、金融期货）- 如：铜期货 (CU2501.SHF)
* **基金市场**（ETF、LOF等）- 如：沪深300ETF (159919.SZ)
* **债券回购**（国债、企业债）- 如：GC001 (204001.SH)
* **可转债市场**（含转股价值、溢价率）- 如：平安转债 (113008.SH)
* **期权市场**（股票期权、指数期权）- 如：50ETF期权 (10001313.SH)

### 📊 指数数据查询
获取主要市场指数数据，如上证指数、深证成指、创业板指等。

### 📰 财经新闻检索 ⭐️ 智能优化
通过真正的搜索API获取主流财经媒体的新闻内容，支持单个或多个关键词智能搜索：
* **支持媒体**：新浪财经、华尔街见闻、同花顺、东方财富、云财经、凤凰网、金融界等
* **搜索功能**：支持单个关键词如'药明康德'、'腾讯'，或多个关键词用空格分开如'美联储 加息'、'比特币 监管'
* **智能匹配**：系统会智能搜索相关历史新闻
* **实时更新**：提供最新的财经资讯和市场动态

### 🏢 公司财务表现分析 ⭐️ 全面整合
获取上市公司综合财务数据，支持智能数据过滤和分批显示：

#### 财务三表数据（已完全整合）
* **利润表** - 营业收入、净利润、毛利率等，支持基础版和完整版
* **资产负债表** - 总资产、负债、股东权益等，智能过滤空字段
* **现金流量表** - 经营、投资、筹资现金流，分类显示更清晰

#### 公司业绩数据
* **业绩预告** - 净利润变动预测、预告类型
* **业绩快报** - 快速财务数据、同比增长率
* **财务指标** - ROE、ROA、流动比率、资产负债率等
* **分红送股** - 现金分红、股票分割、关键日期

#### 主营业务构成
* **按产品分析** - 主营产品收入、利润、成本构成
* **按地区分析** - 地区收入分布、区域业绩对比
* **按行业分析** - 行业收入构成、行业竞争地位

#### 股东信息
* **股东人数** - 股东户数变化趋势
* **股东增减持** - 重要股东买卖情况、持股变动

### 💰 基金数据查询 ⭐️ 全面重构
经过性能优化，查询速度提升85%（从5.2s优化到0.8s）：
* **基金列表** - 基金基本信息、投资类型、管理费率等
* **基金净值** - 单位净值、累计净值、复权净值等，自动整合份额数据
* **基金分红** - 分红方案、现金分红、除权日期等
* **基金持仓** - 重仓股票、市值占比、持股比例等
* **基金经理** - 经理档案、任职期限、管理基金等（已独立为专门工具）

### 👨‍💼 基金经理查询 ⭐️ 独立工具
根据基金经理姓名查询详细信息：
* **个人背景** - 性别、出生年份、学历、国籍
* **任职经历** - 管理基金列表、任职时间、离任情况
* **专业履历** - 详细简历信息、职业发展轨迹

### 📈 宏观经济数据 ⭐️ 中文优化
获取关键宏观经济指标数据，所有描述已全面中文化：
* **Shibor利率** - 上海银行间同业拆放利率
* **LPR利率** - 贷款市场报价利率
* **GDP** - 国内生产总值
* **CPI** - 居民消费价格指数
* **PPI** - 工业生产者出厂价格指数（已修复字段映射Bug）
* **货币供应量** - M0、M1、M2货币供应量数据
* **PMI指数** - 制造业、服务业、综合PMI，包含30+详细分项指标
* **社会融资** - 社会融资规模数据
* **Shibor报价** - 银行报价数据（买入价、卖出价）
* **Libor利率** - 伦敦银行间同业拆借利率
* **Hibor利率** - 香港银行间同业拆借利率

### 🪙 可转债数据 ⭐️ 专业工具
获取可转债全面的非行情数据：

#### 基础信息查询
* **债券详情** - 债券名称、正股代码/名称、存续期、面值
* **交易信息** - 交易所、上市日期、摘牌日期、发行日期
* **转股条款** - 初始转股价、当前转股价、转股期间
* **债券条款** - 利率条款、回售条款、强赎条款、转售条款

#### 发行数据查询
* **发行概况** - 计划/实际发行规模、发行价格、发行方式、发行费用
* **网上发行** - 申购代码/名称、发行日期、申购量、中签率
* **股东配售** - 配售代码/名称、股权登记日、缴款日、配售比例
* **网下发行** - 发行量、保证金比例、申购统计
* **承销信息** - 主承销商、承销量

### 🔄 大宗交易数据 ⭐️ 新增功能
获取大宗交易详细数据：
* **交易详情** - 成交价格、成交量、成交金额
* **交易双方** - 买方营业部、卖方营业部
* **市场统计** - 支持全市场或单个股票的大宗交易查询
* **时间范围** - 灵活的日期范围查询

### 💹 资金流向数据 ⭐️ 新增功能
获取个股和大盘资金流向数据：
* **主力资金** - 主力资金净流入净额和净占比
* **超大单** - 超大单资金流向统计
* **大单/中单/小单** - 各类资金的流入流出情况
* **个股分析** - 单个股票的资金流向分析
* **大盘统计** - 整体市场资金流向趋势

### 🕐 当前时间戳 ⭐️ 实用工具
获取当前东八区（中国时区）的时间信息：
* **多种格式** - datetime、date、time、timestamp、readable
* **中国时区** - 精确的UTC+8时区计算
* **星期信息** - 中文星期显示
* **实时精确** - 精确到秒的当前时间戳
* **美观显示** - 带时区信息的markdown格式显示

### 🤖 MCP集成
与MCP兼容客户端（如Claude）无缝集成，实现智能金融分析。

## 🎯 工具总览

本服务器提供 **11个专业金融工具**：

| 工具名称 | 功能描述 | 主要特性 |
|---------|---------|---------|
| 🕐 **current_timestamp** | 当前时间戳 | 东八区时间，多种格式 |
| 📰 **finance_news** | 财经新闻搜索 | 智能关键词搜索，多媒体源 |
| 📈 **stock_data** | 股票数据查询 | 全球多市场，9种金融工具 |
| 📊 **index_data** | 指数数据查询 | 主要市场指数 |
| 📉 **macro_econ** | 宏观经济数据 | 11种经济指标，中文优化 |
| 🏢 **company_performance** | 公司财务分析 | 财务三表整合，智能过滤 |
| 💰 **fund_data** | 基金数据查询 | 5大类基金数据，性能优化 |
| 👨‍💼 **fund_manager_by_name** | 基金经理查询 | 按姓名查询详细信息 |
| 🪙 **convertible_bond** | 可转债数据 | 基础信息+发行数据 |
| 🔄 **block_trade** | 大宗交易数据 | 交易详情+营业部信息 |
| 💹 **money_flow** | 资金流向数据 | 个股+大盘资金流向 |

## 🔧 技术规格

### 数据源
- **主要API** - [Tushare Pro](https://tushare.pro) 专业金融数据平台
- **覆盖范围** - 中国大陆市场、香港、美国市场及全球指数
- **更新频率** - 实时到日级别，根据数据类型而定
- **历史数据** - 大部分数据类型支持多年历史覆盖

### 支持的市场与工具
- **A股** - 上海证券交易所（SH）和深圳证券交易所（SZ）
- **港股** - 香港证券交易所（HK）
- **美股** - 纳斯达克、纽交所等美国交易所
- **债券** - 国债、企业债、可转债
- **基金** - ETF、共同基金、指数基金
- **衍生品** - 期货、期权、货币对
- **指数** - 主要市场指数和行业指数

### API接口映射
| 工具 | Tushare API | 描述 |
|------|-------------|-----|
| 🕐 时间戳 | `current_timestamp` | 当前时间信息 |
| 📰 财经新闻 | `搜索API` | 智能新闻搜索 |
| 📈 股票数据 | `daily`, `us_daily`, `hk_daily` 等 | 多市场股票数据 |
| 📊 指数数据 | `index_daily` | 市场指数 |
| 📉 宏观经济 | `shibor`, `gdp`, `cpi` 等 | 经济指标 |
| 🏢 公司财务 | `income`, `balancesheet`, `cashflow` 等 | 财务报表 |
| 💰 基金数据 | `fund_basic`, `fund_nav` 等 | 基金信息 |
| 👨‍💼 基金经理 | `fund_manager` | 基金经理信息 |
| 🪙 可转债 | `cb_basic`, `cb_issue` | 可转债数据 |
| 🔄 大宗交易 | `block_trade` | 大宗交易数据 |
| 💹 资金流向 | `moneyflow` | 资金流向数据 |

## 🚦 环境要求

开始使用前，请确保您具备：

1. **Node.js 和 npm**
   * 需要 Node.js 版本 >= 18
   * 从 [nodejs.org](https://nodejs.org/) 下载安装

2. **Tushare API Token**
   * 访问 [tushare.pro](https://tushare.pro/register) 注册并获取API Token
   * 此Token用于访问Tushare提供的金融数据
   * 注意：部分高级数据需要积分权限

## 🛠️ 安装与配置

### 通过Smithery安装（推荐）

如果您使用Claude Desktop，可通过 [Smithery](https://smithery.ai/server/@guangxiangdebizi/finance-mcp) 快速安装：

```bash
npx -y @smithery/cli install @guangxiangdebizi/finance-mcp --client claude
```

### 手动安装

1. **获取代码**
   ```bash
   git clone https://github.com/guangxiangdebizi/FinanceMCP.git
   cd FinanceMCP
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **配置Tushare API Token**
   * 在项目根目录创建 `.env` 文件
   * 添加以下内容：
     ```
     TUSHARE_TOKEN=您的Tushare_API_Token
     ```
   * 或直接在 `src/config.ts` 文件中设置

4. **构建项目**
   ```bash
   npm run build
   ```

## 🚀 启动服务器

有两种方式启动服务器：

### 方式1：使用stdio模式（直接运行）

```bash
node build/index.js
```

### 方式2：使用Supergateway（推荐用于开发）

```bash
npx supergateway --stdio "node build/index.js" --port 3100
```

## 📝 配置MCP客户端

要在Claude或其他MCP客户端中使用此服务器，需要以下配置：

### Claude配置

在Claude的配置文件中添加以下内容：

```json
{
  "mcpServers": {
    "finance-data-server": {
      "url": "http://localhost:3100/sse", // 如使用Supergateway
      "type": "sse",
      "disabled": false,
      "autoApprove": [
        "current_timestamp",
        "finance_news",
        "stock_data",
        "index_data",
        "macro_econ",
        "company_performance",
        "fund_data",
        "fund_manager_by_name",
        "convertible_bond",
        "block_trade",
        "money_flow"
      ]
    }
  }
}
```

如果直接使用stdio模式（不使用Supergateway），配置如下：

```json
{
  "mcpServers": {
    "finance-data-server": {
      "command": "C:/path/to/FinanceMCP/build/index.js", // 修改为实际路径
      "type": "stdio",
      "disabled": false,
      "autoApprove": [
        "current_timestamp",
        "finance_news",
        "stock_data",
        "index_data",
        "macro_econ",
        "company_performance",
        "fund_data",
        "fund_manager_by_name",
        "convertible_bond",
        "block_trade",
        "money_flow"
      ]
    }
  }
}
```

## 💡 使用示例

以下是使用FinanceMCP服务器的一些示例查询：

### 1. 查询股票数据

您可以询问Claude：

**A股查询**
> "查询平安银行（000001.SZ）最近30天的股价数据"

**美股查询**
> "查询苹果公司（AAPL）最近一个月的股价数据"

**港股查询**
> "查询腾讯控股（00700.HK）近期股票表现"

**外汇查询**
> "查询美元人民币（USDCNH.FXCM）近期汇率走势"

**期货查询**
> "查询铜期货（CU2501.SHF）近期市场数据"

**基金查询**
> "查询沪深300ETF（159919.SZ）近期净值表现"

**债券回购查询**
> "查询GC001国债回购（204001.SH）近期利率走势"

**可转债查询**
> "查询平安转债（113008.SH）近期市场数据"

**期权查询**
> "查询50ETF期权（10001313.SH）近期市场数据"

### 2. 获取财经新闻 ⭐️ 智能搜索

您可以询问Claude：

**单个关键词搜索**
> "搜索'药明康德'相关的财经新闻"
> "获取'腾讯'的最新财经资讯"

**多个关键词搜索**
> "搜索'美联储 加息'相关新闻"
> "获取'比特币 监管'相关报道"
> "搜索'新能源汽车 补贴'政策新闻"

**市场热点搜索**
> "搜索'ChatGPT 概念股'相关新闻"
> "获取'房地产 政策'最新动态"

### 3. 查询宏观经济数据

您可以询问Claude：
> "查询最近两年的GDP数据"
> "查询最新的详细PMI采购经理指数数据"
> "查询PPI工业生产者出厂价格指数近期走势"

### 4. 查询公司财务表现 ⭐️ 智能过滤

您可以询问Claude：

**查询财务三表数据**
> "查询平安银行（000001.SZ）最近的利润表数据"
> "查询腾讯控股（00700.HK）资产负债表"
> "查询苹果公司（AAPL）现金流量表"

**查询业绩预告和快报**
> "查询贵州茅台（600519.SH）业绩预告"
> "查询比亚迪（002594.SZ）业绩快报"

**查询财务指标**
> "查询招商银行（600036.SH）财务指标，包括ROE、ROA等"

**查询分红送股**
> "查询中国平安（601318.SH）分红送股历史"

**查询全部财务数据**
> "查询万科A（000002.SZ）综合财务表现数据"

### 5. 查询基金数据 ⭐️ 性能优化

您可以询问Claude：

**查询基金基本信息**
> "查询沪深300ETF（159919.SZ）基本信息"
> "查询所有交易所交易的ETF基金"

**查询基金净值**
> "查询易方达蓝筹精选（005827.OF）近期净值走势"
> "查询华夏沪深300ETF净值表现"

**查询基金持仓**
> "查询长城酒指数基金的重仓股"
> "查询南方中证500ETF持仓详情"

**查询基金分红**
> "查询富国天惠精选成长基金分红历史"

**查询全部基金数据**
> "查询华夏沪深300ETF（510330.SH）所有数据"

### 6. 查询基金经理 ⭐️ 独立工具

您可以询问Claude：

**按姓名查询基金经理**
> "查询基金经理张凯的详细信息"
> "搜索基金经理刘彦春管理的基金"
> "查询易方达基金经理张坤的履历"

### 7. 查询可转债数据

您可以询问Claude：

**查询可转债基本信息**
> "查询可转债110001.SH的基本信息"

**查询可转债发行数据**
> "获取2023年12月公告的可转债发行数据"

**查询全部可转债数据**
> "查询可转债128001.SZ的所有可用数据"

**查询近期可转债发行**
> "查找2024年1月1日到6月30日之间发行的可转债"

### 8. 查询大宗交易数据 ⭐️ 新功能

您可以询问Claude：

**查询个股大宗交易**
> "查询平安银行（000001.SZ）近期大宗交易情况"
> "获取贵州茅台（600519.SH）最近一周的大宗交易数据"

**查询全市场大宗交易**
> "查询今天全市场的大宗交易情况"
> "获取最近一个月全市场大宗交易统计"

### 9. 查询资金流向数据 ⭐️ 新功能

您可以询问Claude：

**查询个股资金流向**
> "查询宁德时代（300750.SZ）近期资金流向"
> "分析比亚迪（002594.SZ）主力资金动向"

**查询大盘资金流向**
> "查询最近一周大盘资金流向趋势"
> "分析当前市场主力资金动向"

### 10. 获取当前时间戳 ⭐️ 实用工具

您可以询问Claude：

**获取当前时间**
> "现在几点了？"
> "今天是几号？"
> "获取当前时间戳"

**不同时间格式**
> "显示当前时间的可读格式"
> "获取Unix时间戳"
> "只显示今天的日期"
> "只显示当前时间"

**时间感知分析**
> "今天是星期几？"
> "获取当前时间用于市场分析"

### 11. 综合数据分析

您可以询问Claude更复杂的问题：
> "结合近期新闻和股价数据，分析平安银行（000001.SZ）的投资前景"
> "结合宏观经济PMI数据和制造业股票表现，分析当前制造业投资机会"
> "当前时间是多少，今天有什么重要的市场新闻？"
> "分析宁德时代的资金流向和近期新闻，判断市场情绪"

Claude将调用多个工具获取所需数据，然后基于这些数据提供分析。

## 📊 数据接口支持

项目当前集成了以下Tushare API接口：

| 功能 | Tushare接口 | 描述 |
|------|-------------|-----|
| 当前时间戳 | current_timestamp | 获取当前东八区时间信息 ⭐️ |
| A股数据 | daily | 获取A股日线行情数据 |
| 美股数据 | us_daily | 获取美股日线行情数据 |
| 港股数据 | hk_daily | 获取港股日线行情数据 |
| 外汇数据 | fx_daily | 获取外汇日线行情数据 ⭐️ 已修复 |
| 期货数据 | fut_daily | 获取期货日线行情数据 |
| 基金数据 | fund_daily | 获取基金日线行情数据 |
| 指数数据 | index_daily | 获取指数日线行情数据 |
| 财经新闻 | 搜索API | 智能搜索主流财经网站新闻 ⭐️ |
| Shibor利率 | shibor_data | 获取上海银行间同业拆放利率 |
| LPR利率 | lpr_data | 获取贷款市场报价利率 |
| GDP | cn_gdp | 获取国内生产总值数据 |
| CPI | cn_cpi | 获取居民消费价格指数数据 |
| PPI | cn_ppi | 获取工业生产者出厂价格指数数据 ⭐️ 已修复 |
| 货币供应量 | cn_m | 获取货币供应量数据（M0、M1、M2） |
| PMI指数 | cn_pmi | 获取采购经理指数数据 ⭐️ 已优化 |
| 社会融资 | cn_sf | 获取社会融资规模数据 |
| Shibor报价 | shibor_quote | 获取Shibor银行报价数据（买入价、卖出价） |
| Libor利率 | libor | 获取伦敦银行间同业拆借利率 |
| Hibor利率 | hibor | 获取香港银行间同业拆借利率 |
| 债券回购 | repo_daily | 获取债券回购日线行情数据 |
| 可转债 | cb_daily | 获取可转债日线行情数据 |
| 期权数据 | opt_daily | 获取期权日线行情数据 |
| 利润表 | income | 获取上市公司利润表数据 ⭐️ 已整合 |
| 资产负债表 | balancesheet | 获取上市公司资产负债表数据 ⭐️ 已整合 |
| 现金流量表 | cashflow | 获取上市公司现金流量表数据 ⭐️ 已整合 |
| 业绩预告 | forecast | 获取上市公司业绩预告数据 |
| 业绩快报 | express | 获取上市公司业绩快报数据 |
| 财务指标 | fina_indicator | 获取上市公司财务指标数据 |
| 分红送股 | dividend | 获取上市公司分红送股数据 |
| 主营构成 | fina_mainbz | 获取主营业务构成数据 |
| 股东人数 | stk_holdernumber | 获取股东人数数据 |
| 股东增减持 | stk_holdertrade | 获取股东增减持数据 |
| 基金列表 | fund_basic | 获取公募基金基本信息 ⭐️ 已优化 |
| 基金净值 | fund_nav | 获取基金净值数据 ⭐️ 已优化 |
| 基金分红 | fund_div | 获取基金分红送配数据 ⭐️ 已修复 |
| 基金持仓 | fund_portfolio | 获取基金持仓明细 ⭐️ 已优化 |
| 基金经理 | fund_manager | 获取基金经理信息 ⭐️ 独立工具 |
| 可转债基本信息 | cb_basic | 获取可转债基本信息 ⭐️ |
| 可转债发行 | cb_issue | 获取可转债发行数据 ⭐️ |
| 大宗交易 | block_trade | 获取大宗交易数据 ⭐️ 新增 |
| 资金流向 | moneyflow | 获取个股和大盘资金流向数据 ⭐️ 新增 |

## 🔮 未来规划

未来计划集成更多Tushare数据接口，包括但不限于：

1. **基础数据** - 股票列表、交易日历、停复牌信息等
2. **更多财务数据** - 财务审计意见、主营业务构成、股东信息等 ⭐️ 部分已实现
3. **更多新闻数据** - 公告信息、研报数据等 ⭐️ 部分已实现
4. **技术分析指标** - MACD、RSI、布林带等技术指标
5. **行业数据** - 行业分类、行业指数、行业对比分析等
6. **衍生品数据** - 更多期权、期货合约数据
7. **另类数据** - ESG评级、机构调研、股东大会等

参见 `tushare-interfaces.md` 文件了解更多可能集成的数据接口。

## 📈 最新更新

### v0.2.0 主要更新
- ✅ **财务三表整合** - 利润表、资产负债表、现金流量表完全整合到company_performance工具
- ✅ **智能数据过滤** - 自动过滤空字段，只显示有实际数据的项目
- ✅ **基金数据优化** - 查询性能提升85%，从独立工具拆分基金经理查询功能
- ✅ **外汇数据修复** - 修复外汇字段映射错误，正确显示买入/卖出价格
- ✅ **PPI数据修复** - 修复PPI字段映射Bug，正确显示工业生产者价格指数
- ✅ **新增大宗交易工具** - 支持个股和全市场大宗交易数据查询
- ✅ **新增资金流向工具** - 支持个股和大盘资金流向分析
- ✅ **中文化优化** - 宏观经济模块全面中文化
- ✅ **分批显示优化** - 大数据量表格智能分批显示，提升可读性

## 📄 许可证

本项目采用MIT许可证。详情请参见 [LICENSE](LICENSE) 文件。

## 👨‍💻 作者

- 姓名：陈星宇 (Xingyu Chen)
- 邮箱：guangxiangdebizi@gmail.com
- GitHub：[guangxiangdebizi](https://github.com/guangxiangdebizi)

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## ⭐ 支持项目

如果这个项目对您有帮助，请给我们一个Star！您的支持是我们持续改进的动力。
